{"ast":null,"code":"var _jsxFileName = \"/home/akshajkanumuri/GitHub/VS-Code-Projects/Web Development/Chat Application/src/Settings.jsx\",\n  _s = $RefreshSig$();\nimport React, { useContext, useState } from \"react\";\nimport icon from \"../src/img/photo.png\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { AuthContext } from \"./context/AuthContext\";\nimport { getDownloadURL, ref, uploadBytesResumable } from \"firebase/storage\";\nimport { db, storage } from \"./firebase\";\nimport { v4 as uuid } from \"uuid\";\nimport { doc, updateDoc } from \"firebase/firestore\";\nimport { updateProfile } from \"firebase/auth\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Settings = () => {\n  _s();\n  const [err, setErr] = useState(false);\n  const navigate = useNavigate();\n  const {\n    currentUser\n  } = useContext(AuthContext);\n  const [text, setText] = useState(\"\");\n  const [img, setImg] = useState(null);\n  const [blank, setBlank] = useState(false);\n  const delayInMilliseconds = 100;\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const displayName = e.target[0].value;\n    console.log(currentUser.uid);\n    try {\n      if (img && text !== \"\") {\n        setBlank(false);\n        const storageRef = ref(storage, uuid());\n        const uploadTask = uploadBytesResumable(storageRef, img);\n        uploadTask.on(error => {}, async () => {\n          await getDownloadURL(uploadTask.snapshot.ref).then(async downloadURL => {\n            await updateDoc(doc(db, \"users\", currentUser.uid), {\n              displayName,\n              photoURL: downloadURL\n            });\n            await updateProfile(currentUser, {\n              displayName,\n              photoURL: downloadURL\n            });\n          });\n        });\n        setTimeout(function () {\n          navigate(\"/\");\n        }, delayInMilliseconds);\n      } else if (img === null && text !== \"\") {\n        setBlank(false);\n        await updateDoc(doc(db, \"users\", currentUser.uid), {\n          displayName\n        });\n        await updateProfile(currentUser, {\n          displayName\n        });\n        setTimeout(function () {\n          navigate(\"/\");\n        }, delayInMilliseconds);\n      } else if (img && text === \"\") {\n        setBlank(false);\n        const storageRef = ref(storage, uuid());\n        const uploadTask = uploadBytesResumable(storageRef, img);\n        uploadTask.on(error => {}, async () => {\n          await getDownloadURL(uploadTask.snapshot.ref).then(async downloadURL => {\n            await updateDoc(doc(db, \"users\", currentUser.uid), {\n              photoURL: downloadURL\n            });\n            await updateProfile(currentUser, {\n              photoURL: downloadURL\n            });\n          });\n        });\n        setTimeout(function () {\n          navigate(\"/\");\n        }, delayInMilliseconds);\n      } else {\n        setBlank(true);\n      }\n      setText(\"\");\n      setImg(null);\n      setTimeout(function () {\n        navigate(\"/\");\n      }, delayInMilliseconds);\n    } catch (err) {\n      setErr(true);\n    }\n    console.log(currentUser);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"formContainer\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"formWrapper\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"logo\",\n        children: \"Settings\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"title\",\n        children: \"Update Profile\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: handleSubmit,\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          type: \"text\",\n          placeholder: \"New display name\",\n          onChange: e => setText(e.target.value),\n          value: text\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 113,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          style: {\n            display: \"none\"\n          },\n          type: \"file\",\n          id: \"file\",\n          onChange: e => setImg(e.target.files[0])\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 114,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"file\",\n          placeholder: \"https://cdn-icons-png.flaticon.com/512/456/456212.png\",\n          children: [/*#__PURE__*/_jsxDEV(\"img\", {\n            src: icon,\n            alt: \"\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 116,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: \"New avatar\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 117,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 115,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          children: \"Save Changes\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 119,\n          columnNumber: 21\n        }, this), err && /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Something went wrong\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 120,\n          columnNumber: 29\n        }, this), blank && /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"No changes have been made!\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 31\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\"Don't want to make any changes? \", /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/\",\n          children: \"Return Home\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 123,\n          columnNumber: 52\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 123,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 13\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 107,\n    columnNumber: 9\n  }, this);\n};\n_s(Settings, \"1lN4jIyJ2OBVLhwvj11SXYuINL4=\", false, function () {\n  return [useNavigate];\n});\n_c = Settings;\nexport default Settings;\nvar _c;\n$RefreshReg$(_c, \"Settings\");","map":{"version":3,"names":["React","useContext","useState","icon","Link","useNavigate","AuthContext","getDownloadURL","ref","uploadBytesResumable","db","storage","v4","uuid","doc","updateDoc","updateProfile","jsxDEV","_jsxDEV","Settings","_s","err","setErr","navigate","currentUser","text","setText","img","setImg","blank","setBlank","delayInMilliseconds","handleSubmit","e","preventDefault","displayName","target","value","console","log","uid","storageRef","uploadTask","on","error","snapshot","then","downloadURL","photoURL","setTimeout","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onSubmit","type","placeholder","onChange","style","display","id","files","htmlFor","src","alt","to","_c","$RefreshReg$"],"sources":["/home/akshajkanumuri/GitHub/VS-Code-Projects/Web Development/Chat Application/src/Settings.jsx"],"sourcesContent":["import React, { useContext, useState } from \"react\";\nimport icon from \"../src/img/photo.png\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport { AuthContext } from \"./context/AuthContext\";\nimport { getDownloadURL, ref, uploadBytesResumable } from \"firebase/storage\";\nimport { db, storage } from \"./firebase\";\nimport { v4 as uuid } from \"uuid\"\nimport { doc, updateDoc } from \"firebase/firestore\";\nimport { updateProfile } from \"firebase/auth\";\n\nconst Settings = () => {\n    const [err, setErr] = useState(false);\n    const navigate = useNavigate();\n    const {currentUser} = useContext(AuthContext);\n    const [ text, setText ] = useState(\"\");\n    const [ img, setImg ] = useState(null);\n    const [ blank, setBlank ] = useState(false);\n    const delayInMilliseconds = 100;\n\n    const handleSubmit = async (e) => {\n      e.preventDefault();\n      const displayName = e.target[0].value;\n\n      console.log(currentUser.uid);\n\n      try{\n        if(img && text !== \"\"){\n        setBlank(false);\n        const storageRef = ref(storage,  uuid());\n\n        const uploadTask = uploadBytesResumable(storageRef, img);\n\n        uploadTask.on(\n            (error) => {\n\n            },\n            async () => {\n                await getDownloadURL(uploadTask.snapshot.ref).then(async (downloadURL) => {\n                    await updateDoc(doc(db, \"users\", currentUser.uid),{\n                        displayName,\n                        photoURL: downloadURL,\n                    })\n                    await updateProfile(currentUser, {\n                        displayName,\n                        photoURL: downloadURL,\n                    })\n                })\n            }\n        )\n        setTimeout(function(){\n            navigate(\"/\");\n        }, delayInMilliseconds);\n      }\n      else if(img === null && text !== \"\"){\n        setBlank(false);\n        await updateDoc(doc(db, \"users\", currentUser.uid), {\n            displayName,\n        })\n        await updateProfile(currentUser, {\n            displayName,\n        })\n        setTimeout(function(){\n            navigate(\"/\")\n        }, delayInMilliseconds);\n      }\n      else if(img && text === \"\")\n      {\n        setBlank(false);\n        const storageRef = ref(storage, uuid());\n        const uploadTask = uploadBytesResumable(storageRef, img);\n\n        uploadTask.on(\n            (error) => {\n\n            },\n            async () => {\n                await getDownloadURL(uploadTask.snapshot.ref).then(async (downloadURL) => {\n                    await updateDoc(doc(db, \"users\", currentUser.uid),{\n                        photoURL: downloadURL,\n                    })\n                    await updateProfile(currentUser, {\n                        photoURL: downloadURL,\n                    })\n                })\n            }\n        )\n        setTimeout(function(){\n            navigate(\"/\")\n        }, delayInMilliseconds);\n      }\n      else{\n        setBlank(true);\n      }\n\n      setText(\"\");\n      setImg(null);\n      setTimeout(function(){\n        navigate(\"/\");\n      }, delayInMilliseconds);\n    }\n    catch(err){\n        setErr(true);\n    }\n    console.log(currentUser);\n  };\n    return(\n        <div className=\"formContainer\">\n\n            <div className=\"formWrapper\">\n                <span className=\"logo\">Settings</span>\n                <span className=\"title\">Update Profile</span>\n                <form onSubmit={handleSubmit}>\n                    <input type=\"text\" placeholder=\"New display name\" onChange={e=>setText(e.target.value)} value={text}/>\n                    <input style={{display: \"none\"}} type=\"file\" id=\"file\" onChange={e=>setImg(e.target.files[0])}/>\n                    <label htmlFor=\"file\" placeholder=\"https://cdn-icons-png.flaticon.com/512/456/456212.png\">\n                        <img src={icon} alt=\"\" />\n                        <span>New avatar</span>\n                    </label>\n                    <button>Save Changes</button>\n                    {err && <span>Something went wrong</span>}\n                    {blank && <span>No changes have been made!</span>}\n                </form>\n                <p>Don't want to make any changes? <Link to=\"/\">Return Home</Link></p>\n            </div>\n        </div>\n    )\n}\n\nexport default Settings"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}